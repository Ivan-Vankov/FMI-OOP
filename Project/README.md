# Електронна таблица

### Представяне на данните:
*   Всеки ред във файла е ред в таблицата.
*   Всеки ред във файла съдържа данни(`клетки`) разделени със запетаи.
*   Всеки ред в таблицата може да съдържа различен брой клетки.
*   Празен ред във файла представя празен ред в таблицата.
*   Между две запетаи във файла може да няма никакви данни(празна клетка).
*   Между данните и запетаите може да има произволен брой празни символи.

### Типове данни в таблицата
*   `Цяло число`: Поредица от цифри. Може да има '+' или '-' в началото.
*   `Дробно число`: Поредица от цифри, следвана от точка и друга поредица от цифри. Може да има '+' или '-' в началото.
*   `Символен низ`: Поредица от произволни символи оградени в кавички. Както низовете в C++, за да се използва кавичка, трябва да се напише `\"`, а наклонена черта `\\`.
*   `Дата`: Поредица от три числа, разделени с точка, представяща датата във формат dd.mm.yyyy или yyyy.mm.dd. 
*   `Формула`: Започва със символ за равенство. В нея може да има: събиране (+), изваждане (-), умножение (*), деление (/) и степенуване (^). Във формулата могат да участват или числа или препратки към клетки в таблицата. При препратка към клетка се използва стойността на клетка. 


### Таблицата трябва да поддържа следните команди:
*   `open`  : Зарежда файл в паметта
*   `close` : Затваря текущия файл
*   `save`  : Записва правените промени в същия файл
*   `saveas`: Записва правените промени в подаден файл
*   `exit`  : Излиза от програмата
*   `print` : Извежда съдържанието на таблицата на екрана
*   `edit`  : Редактира съдържанието на дадена клетка

### Извеждане на таблицата на екрана
При извеждане на таблицата с `print`, данните в колоните трябва да се подравнят. Между отделните колони трябва да се поставят символи за отвесна черта (|). 

*Входен файл*
```
10, "Hello world!", 123.56
"\"Quoted\""
1, 2, 3, 4	
```
*Извеждане*
```
10       | Hello world! | 123.56 |   |
"Quoted" |              |        |   |
1        |            2 |      3 | 4 |
```

### Редактиране на клетки
При редактиране на клетки с `edit` се подават реда и колоната на клетка и стойност, която да запишем в нея. 
```
edit R0C1 "Hello world!"
> Successfully edited cell R0C1
```
### Формули
Номерата на редовете и клетките в таблицата започват от 0. Препратка към ред <N> и колона <M> в таблицата се записва така: R<N>C<M>. 

При сметките важат следните правила:
*   Ако в дадена формула участват само числа, то сметката се извършва по традиционните правила на аритметиката.
*   Ако в дадена формула участва низ, той трябва да се конвертира до число. Това става по следния начин: Ако низът съдържа запис на число, той се конвертира до съответното число. Всички други низове се конвертират до нула. 
*   Ако в дадена формула участва дата, тя трябва да се преобразува до броя дни изминали от 01.01.1900 до нея.
*   Ако в дадена формула участва празна клетка, тя се конвертира до нула. Това важи и за клетки, чиито координати надхвърлят размерите на таблицата.
*   Ако в дадена формула има грешка (например деление на нула), в съответната клетка се извежда ERROR.